# Zip-Slip - SharpCompress 
##### By ProjectZero / CVE-2018-1002206

## Overview
Zip-Slip occur in Zip-libraries like SharpCompress which intend to compress multiple data to one archive (e.g. zip, 7zip, ...) or extract files out of a given archive.

## Vulnerability
A Zip-Slip describes the possibility to overwrite files outside the folder, where the archive-files should be extract. The exploits uses directory traversal filename in a given archive (e.g.. ```../my-evil-file.js```)

### path traversal archive 
Since operation system normally not allow dots or slashes in filename, the archive has to be created first. Afterwards the name of the file could easily be changed with an cli for archives.

Example of an zip file with a path traversal file:
![Zip-file](./images/exploit-zip-ls.png)

### Fix
The library which handles the export have to check, if the resolved destination path of each file (i.e. ```/my-evil-file.js``` instead of ```/test/../my-evil-file.js```) includes the chosen destination path in it.

A simple example how the fix could look like is given below:
```c#
if (!destdir.StartsWith(fullDestinationDirectoryPath))
{
    throw new ExtractionException("Entry is trying to create a directory outside of the destination directory.");
}
```


## ExploitScript
TODO with CASP-10352
- login as admanager
- upload zip archive

##### Requirements:
TODO with CASP-10352
- vulnerable zip file
- permission for uploading the file to the server

##### Usage:
TODO with CASP-10352
- execute command
